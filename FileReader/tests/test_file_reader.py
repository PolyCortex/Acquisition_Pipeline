import unittest
import os, time, sys
import numpy as np
sys.path.insert(1, os.path.join(sys.path[0], '..'))
from FileReader import FileReader


correctDataSanitized = np.array([
    [7.711910000000000000e+05,-1.256109000000000000e+06,1.878483000000000000e+06,-6.062700000000000000e+04,-1.497296000000000000e+06,-1.735890000000000000e+05,-2.703454000000000000e+06,-5.216290000000000000e+05,1.074966809749603271e+02,0.000000000000000000e+00],
    [7.716330000000000000e+05,-1.255698000000000000e+06,1.881883000000000000e+06,-5.717300000000000000e+04,-1.510177000000000000e+06,-1.864520000000000000e+05,-2.716553000000000000e+06,-5.210390000000000000e+05,1.074967792034149170e+02,0.000000000000000000e+00],
    [7.693840000000000000e+05,-1.257407000000000000e+06,1.877658000000000000e+06,-6.146300000000000000e+04,-1.508727000000000000e+06,-1.851910000000000000e+05,-2.715172000000000000e+06,-5.230900000000000000e+05,1.074976110458374023e+02,0.000000000000000000e+00],
    [7.684970000000000000e+05,-1.258116000000000000e+06,1.872229000000000000e+06,-6.675600000000000000e+04,-1.490569000000000000e+06,-1.671340000000000000e+05,-2.696562000000000000e+06,-5.231990000000000000e+05,1.074977631568908691e+02,0.000000000000000000e+00],
    [7.741410000000000000e+05,-1.253128000000000000e+06,1.876061000000000000e+06,-6.228900000000000000e+04,-1.495412000000000000e+06,-1.717330000000000000e+05,-2.701554000000000000e+06,-5.203470000000000000e+05,1.075500881671905518e+02,0.000000000000000000e+00],
    [7.753030000000000000e+05,-1.252021000000000000e+06,1.881286000000000000e+06,-5.766900000000000000e+04,-1.506276000000000000e+06,-1.826410000000000000e+05,-2.712701000000000000e+06,-5.181990000000000000e+05,1.075506181716918945e+02,0.000000000000000000e+00],
    [7.727340000000000000e+05,-1.254451000000000000e+06,1.878387000000000000e+06,-6.078500000000000000e+04,-1.510562000000000000e+06,-1.872370000000000000e+05,-2.717219000000000000e+06,-5.200320000000000000e+05,1.075513458251953125e+02,0.000000000000000000e+00],
    [7.695210000000000000e+05,-1.257532000000000000e+06,1.874186000000000000e+06,-6.490300000000000000e+04,-1.490216000000000000e+06,-1.670560000000000000e+05,-2.696704000000000000e+06,-5.237870000000000000e+05,1.075514452457427979e+02,0.000000000000000000e+00],
    [7.716240000000000000e+05,-1.255674000000000000e+06,1.876478000000000000e+06,-6.244400000000000000e+04,-1.494497000000000000e+06,-1.707910000000000000e+05,-2.701070000000000000e+06,-5.216150000000000000e+05,1.075520732402801514e+02,0.000000000000000000e+00],
    [7.732260000000000000e+05,-1.254325000000000000e+06,1.877294000000000000e+06,-6.162100000000000000e+04,-1.504744000000000000e+06,-1.809300000000000000e+05,-2.711577000000000000e+06,-5.198870000000000000e+05,1.075524554252624512e+02,0.000000000000000000e+00],
    [7.726810000000000000e+05,-1.254773000000000000e+06,1.873749000000000000e+06,-6.513500000000000000e+04,-1.515229000000000000e+06,-1.915360000000000000e+05,-2.722080000000000000e+06,-5.205470000000000000e+05,1.075525708198547363e+02,0.000000000000000000e+00],
    [7.674290000000000000e+05,-1.259594000000000000e+06,1.871918000000000000e+06,-6.719700000000000000e+04,-1.494821000000000000e+06,-1.714810000000000000e+05,-2.701186000000000000e+06,-5.245220000000000000e+05,1.075532627105712891e+02,0.000000000000000000e+00],
    [7.703200000000000000e+05,-1.256621000000000000e+06,1.873532000000000000e+06,-6.566400000000000000e+04,-1.494519000000000000e+06,-1.709270000000000000e+05,-2.700632000000000000e+06,-5.223140000000000000e+05,1.075534145832061768e+02,0.000000000000000000e+00],
    [7.719260000000000000e+05,-1.255095000000000000e+06,1.875541000000000000e+06,-6.341100000000000000e+04,-1.502852000000000000e+06,-1.792510000000000000e+05,-2.709202000000000000e+06,-5.218070000000000000e+05,1.075540449619293213e+02,0.000000000000000000e+00],
    [7.735690000000000000e+05,-1.253544000000000000e+06,1.875225000000000000e+06,-6.372700000000000000e+04,-1.515577000000000000e+06,-1.921300000000000000e+05,-2.722175000000000000e+06,-5.196610000000000000e+05,1.075542860031127930e+02,0.000000000000000000e+00],
    [7.711360000000000000e+05,-1.255611000000000000e+06,1.874162000000000000e+06,-6.472700000000000000e+04,-1.496282000000000000e+06,-1.734320000000000000e+05,-2.702754000000000000e+06,-5.216720000000000000e+05,1.075545022487640381e+02,0.000000000000000000e+00],
    [7.716440000000000000e+05,-1.255041000000000000e+06,1.875560000000000000e+06,-6.317200000000000000e+04,-1.492174000000000000e+06,-1.690760000000000000e+05,-2.698348000000000000e+06,-5.207780000000000000e+05,1.075545930862426758e+02,0.000000000000000000e+00],
    [7.721090000000000000e+05,-1.254737000000000000e+06,1.876012000000000000e+06,-6.240400000000000000e+04,-1.500391000000000000e+06,-1.770940000000000000e+05,-2.706916000000000000e+06,-5.203340000000000000e+05,1.075553355216979980e+02,0.000000000000000000e+00],
    [7.724900000000000000e+05,-1.254357000000000000e+06,1.875533000000000000e+06,-6.274200000000000000e+04,-1.515429000000000000e+06,-1.920310000000000000e+05,-2.721984000000000000e+06,-5.203140000000000000e+05,1.075554268360137939e+02,0.000000000000000000e+00],
    [7.685460000000000000e+05,-1.258085000000000000e+06,1.867678000000000000e+06,-7.084900000000000000e+04,-1.502170000000000000e+06,-1.791370000000000000e+05,-2.708489000000000000e+06,-5.240250000000000000e+05,1.076109731197357178e+02,0.000000000000000000e+00],
    [7.702540000000000000e+05,-1.256439000000000000e+06,1.868099000000000000e+06,-7.036900000000000000e+04,-1.492432000000000000e+06,-1.692920000000000000e+05,-2.698324000000000000e+06,-5.223920000000000000e+05,1.076121292114257812e+02,0.000000000000000000e+00],
    [7.719750000000000000e+05,-1.254531000000000000e+06,1.880794000000000000e+06,-5.736400000000000000e+04,-1.498089000000000000e+06,-1.748590000000000000e+05,-2.704339000000000000e+06,-5.211910000000000000e+05,1.076122338771820068e+02,0.000000000000000000e+00],
    [7.744880000000000000e+05,-1.251949000000000000e+06,1.880984000000000000e+06,-5.709900000000000000e+04,-1.512463000000000000e+06,-1.892640000000000000e+05,-2.718977000000000000e+06,-5.194560000000000000e+05,1.076123588085174561e+02,0.000000000000000000e+00],
    [7.705820000000000000e+05,-1.255386000000000000e+06,1.873852000000000000e+06,-6.409400000000000000e+04,-1.505291000000000000e+06,-1.825310000000000000e+05,-2.711733000000000000e+06,-5.226120000000000000e+05,1.076131379604339600e+02,0.000000000000000000e+00],
    [7.709590000000000000e+05,-1.255064000000000000e+06,1.873787000000000000e+06,-6.431900000000000000e+04,-1.490644000000000000e+06,-1.679470000000000000e+05,-2.696479000000000000e+06,-5.227360000000000000e+05,1.076137874126434326e+02,0.000000000000000000e+00],
    [7.729410000000000000e+05,-1.253154000000000000e+06,1.875616000000000000e+06,-6.223600000000000000e+04,-1.497283000000000000e+06,-1.742830000000000000e+05,-2.703181000000000000e+06,-5.212980000000000000e+05,1.076141703128814697e+02,0.000000000000000000e+00],
    [7.736710000000000000e+05,-1.252608000000000000e+06,1.877273000000000000e+06,-6.051900000000000000e+04,-1.510301000000000000e+06,-1.872110000000000000e+05,-2.716383000000000000e+06,-5.196620000000000000e+05,1.076142680644989014e+02,0.000000000000000000e+00],
    [7.702040000000000000e+05,-1.255963000000000000e+06,1.873108000000000000e+06,-6.452200000000000000e+04,-1.508571000000000000e+06,-1.857260000000000000e+05,-2.714821000000000000e+06,-5.203260000000000000e+05,1.076151804924011230e+02,0.000000000000000000e+00],
    [7.690800000000000000e+05,-1.256909000000000000e+06,1.872500000000000000e+06,-6.503700000000000000e+04,-1.490081000000000000e+06,-1.671790000000000000e+05,-2.695956000000000000e+06,-5.210760000000000000e+05,1.076161456108093262e+02,0.000000000000000000e+00],
    [7.712510000000000000e+05,-1.254925000000000000e+06,1.874593000000000000e+06,-6.298100000000000000e+04,-1.496342000000000000e+06,-1.730060000000000000e+05,-2.702384000000000000e+06,-5.203830000000000000e+05,1.076165215969085693e+02,0.000000000000000000e+00],
    [7.730930000000000000e+05,-1.253301000000000000e+06,1.871300000000000000e+06,-6.628400000000000000e+04,-1.508610000000000000e+06,-1.852290000000000000e+05,-2.714984000000000000e+06,-5.198490000000000000e+05,1.076172702312469482e+02,0.000000000000000000e+00],
    [7.709480000000000000e+05,-1.255272000000000000e+06,1.867085000000000000e+06,-7.047900000000000000e+04,-1.514139000000000000e+06,-1.909630000000000000e+05,-2.720604000000000000e+06,-5.214960000000000000e+05,1.076174860000610352e+02,0.000000000000000000e+00],
    [7.671330000000000000e+05,-1.258889000000000000e+06,1.868616000000000000e+06,-6.878900000000000000e+04,-1.493333000000000000e+06,-1.703620000000000000e+05,-2.699184000000000000e+06,-5.235750000000000000e+05,1.076176404953002930e+02,0.000000000000000000e+00],
    [7.689130000000000000e+05,-1.257252000000000000e+06,1.874893000000000000e+06,-6.253500000000000000e+04,-1.495947000000000000e+06,-1.726820000000000000e+05,-2.701704000000000000e+06,-5.212760000000000000e+05,1.076183691024780273e+02,0.000000000000000000e+00],
    [7.699520000000000000e+05,-1.256367000000000000e+06,1.875741000000000000e+06,-6.160200000000000000e+04,-1.505744000000000000e+06,-1.824520000000000000e+05,-2.711721000000000000e+06,-5.201820000000000000e+05,1.076699345111846924e+02,0.000000000000000000e+00],
    [7.701180000000000000e+05,-1.256246000000000000e+06,1.875620000000000000e+06,-6.143000000000000000e+04,-1.515984000000000000e+06,-1.927490000000000000e+05,-2.721989000000000000e+06,-5.211950000000000000e+05,1.076701231002807617e+02,0.000000000000000000e+00],
    [7.665410000000000000e+05,-1.259646000000000000e+06,1.870664000000000000e+06,-6.646500000000000000e+04,-1.495616000000000000e+06,-1.727960000000000000e+05,-2.701178000000000000e+06,-5.235650000000000000e+05,1.076703722476959229e+02,0.000000000000000000e+00],
    [7.683680000000000000e+05,-1.257857000000000000e+06,1.872404000000000000e+06,-6.493000000000000000e+04,-1.494893000000000000e+06,-1.719440000000000000e+05,-2.700301000000000000e+06,-5.207270000000000000e+05,1.076704723834991455e+02,0.000000000000000000e+00],
    [7.706290000000000000e+05,-1.255791000000000000e+06,1.874134000000000000e+06,-6.291100000000000000e+04,-1.502958000000000000e+06,-1.799570000000000000e+05,-2.708611000000000000e+06,-5.203130000000000000e+05,1.076713736057281494e+02,0.000000000000000000e+00],
    [7.706420000000000000e+05,-1.255637000000000000e+06,1.873224000000000000e+06,-6.377500000000000000e+04,-1.516417000000000000e+06,-1.934770000000000000e+05,-2.722243000000000000e+06,-5.200690000000000000e+05,1.076732738018035889e+02,0.000000000000000000e+00],
    [7.660580000000000000e+05,-1.259986000000000000e+06,1.868502000000000000e+06,-6.860300000000000000e+04,-1.498332000000000000e+06,-1.759920000000000000e+05,-2.704012000000000000e+06,-5.243940000000000000e+05,1.076754100322723389e+02,0.000000000000000000e+00],
    [7.688520000000000000e+05,-1.257456000000000000e+06,1.869122000000000000e+06,-6.786700000000000000e+04,-1.493255000000000000e+06,-1.707320000000000000e+05,-2.698626000000000000e+06,-5.224120000000000000e+05,1.076786615848541260e+02,0.000000000000000000e+00],
    [7.700280000000000000e+05,-1.256582000000000000e+06,1.870132000000000000e+06,-6.699300000000000000e+04,-1.500906000000000000e+06,-1.782090000000000000e+05,-2.706617000000000000e+06,-5.212840000000000000e+05,1.076794879436492920e+02,0.000000000000000000e+00],
    [7.721630000000000000e+05,-1.254546000000000000e+06,1.876595000000000000e+06,-6.045600000000000000e+04,-1.514397000000000000e+06,-1.917560000000000000e+05,-2.720265000000000000e+06,-5.202710000000000000e+05,1.076807820796966553e+02,0.000000000000000000e+00],
    [7.692440000000000000e+05,-1.257116000000000000e+06,1.873221000000000000e+06,-6.368400000000000000e+04,-1.500435000000000000e+06,-1.781960000000000000e+05,-2.706170000000000000e+06,-5.228690000000000000e+05,1.076808760166168213e+02,0.000000000000000000e+00],
    [7.687260000000000000e+05,-1.257539000000000000e+06,1.874216000000000000e+06,-6.252600000000000000e+04,-1.490769000000000000e+06,-1.683680000000000000e+05,-2.696080000000000000e+06,-5.199970000000000000e+05,1.076816887855529785e+02,0.000000000000000000e+00],
    [7.699530000000000000e+05,-1.256455000000000000e+06,1.873376000000000000e+06,-6.380100000000000000e+04,-1.498442000000000000e+06,-1.758590000000000000e+05,-2.704102000000000000e+06,-5.179130000000000000e+05,1.076818525791168213e+02,0.000000000000000000e+00],
    [7.725690000000000000e+05,-1.254124000000000000e+06,1.875228000000000000e+06,-6.169000000000000000e+04,-1.512487000000000000e+06,-1.899300000000000000e+05,-2.718435000000000000e+06,-5.186150000000000000e+05,1.076826090812683105e+02,0.000000000000000000e+00],
    [7.688770000000000000e+05,-1.257605000000000000e+06,1.869289000000000000e+06,-6.733500000000000000e+04,-1.505304000000000000e+06,-1.830790000000000000e+05,-2.711229000000000000e+06,-5.243710000000000000e+05,1.076839675903320312e+02,0.000000000000000000e+00],
    [7.677740000000000000e+05,-1.258602000000000000e+06,1.868493000000000000e+06,-6.830200000000000000e+04,-1.491114000000000000e+06,-1.687770000000000000e+05,-2.696522000000000000e+06,-5.266430000000000000e+05,1.077298147678375244e+02,0.000000000000000000e+00],
    [7.704550000000000000e+05,-1.256182000000000000e+06,1.872247000000000000e+06,-6.437900000000000000e+04,-1.497402000000000000e+06,-1.748330000000000000e+05,-2.703036000000000000e+06,-5.242530000000000000e+05,1.077314772605895996e+02,0.000000000000000000e+00],
    [7.738490000000000000e+05,-1.253113000000000000e+06,1.873848000000000000e+06,-6.297100000000000000e+04,-1.510151000000000000e+06,-1.875870000000000000e+05,-2.715966000000000000e+06,-5.206860000000000000e+05,1.077316060066223145e+02,0.000000000000000000e+00],
    [7.713080000000000000e+05,-1.255424000000000000e+06,1.871013000000000000e+06,-6.569300000000000000e+04,-1.509856000000000000e+06,-1.876110000000000000e+05,-2.715595000000000000e+06,-5.216480000000000000e+05,1.077341101169586182e+02,0.000000000000000000e+00],
    [7.711760000000000000e+05,-1.255497000000000000e+06,1.867081000000000000e+06,-6.977700000000000000e+04,-1.491139000000000000e+06,-1.692990000000000000e+05,-2.696344000000000000e+06,-5.214450000000000000e+05,1.077355172634124756e+02,0.000000000000000000e+00],
    [7.734800000000000000e+05,-1.253376000000000000e+06,1.867630000000000000e+06,-6.904700000000000000e+04,-1.495914000000000000e+06,-1.740700000000000000e+05,-2.701238000000000000e+06,-5.189670000000000000e+05,1.077356190681457520e+02,0.000000000000000000e+00],
    [7.727910000000000000e+05,-1.254046000000000000e+06,1.875347000000000000e+06,-6.132300000000000000e+04,-1.506502000000000000e+06,-1.846510000000000000e+05,-2.711987000000000000e+06,-5.187760000000000000e+05,1.077364158630371094e+02,0.000000000000000000e+00],
    [7.725060000000000000e+05,-1.254149000000000000e+06,1.874744000000000000e+06,-6.159800000000000000e+04,-1.511603000000000000e+06,-1.899060000000000000e+05,-2.717215000000000000e+06,-5.208960000000000000e+05,1.077370350360870361e+02,0.000000000000000000e+00],
    [7.706440000000000000e+05,-1.255752000000000000e+06,1.871375000000000000e+06,-6.484400000000000000e+04,-1.490664000000000000e+06,-1.692790000000000000e+05,-2.695864000000000000e+06,-5.225970000000000000e+05,1.077371642589569092e+02,0.000000000000000000e+00],
    [7.725760000000000000e+05,-1.254112000000000000e+06,1.872158000000000000e+06,-6.397600000000000000e+04,-1.493771000000000000e+06,-1.721570000000000000e+05,-2.698984000000000000e+06,-5.207120000000000000e+05,1.077375159263610840e+02,0.000000000000000000e+00],
    [7.730180000000000000e+05,-1.253848000000000000e+06,1.869616000000000000e+06,-6.597000000000000000e+04,-1.503959000000000000e+06,-1.823070000000000000e+05,-2.709529000000000000e+06,-5.202440000000000000e+05,1.077376086711883545e+02,0.000000000000000000e+00],
    [7.737640000000000000e+05,-1.252927000000000000e+06,1.872507000000000000e+06,-6.276200000000000000e+04,-1.513448000000000000e+06,-1.919590000000000000e+05,-2.719277000000000000e+06,-5.199590000000000000e+05,1.077382283210754395e+02,0.000000000000000000e+00],
    [7.693870000000000000e+05,-1.257056000000000000e+06,1.867659000000000000e+06,-6.802700000000000000e+04,-1.493182000000000000e+06,-1.720940000000000000e+05,-2.698709000000000000e+06,-5.220340000000000000e+05,1.077399008274078369e+02,0.000000000000000000e+00],
    [7.704780000000000000e+05,-1.256177000000000000e+06,1.868189000000000000e+06,-6.746900000000000000e+04,-1.492807000000000000e+06,-1.715260000000000000e+05,-2.698207000000000000e+06,-5.196470000000000000e+05,1.077403199672698975e+02,0.000000000000000000e+00],
    [7.717050000000000000e+05,-1.255143000000000000e+06,1.871368000000000000e+06,-6.471400000000000000e+04,-1.501043000000000000e+06,-1.797060000000000000e+05,-2.706659000000000000e+06,-5.205310000000000000e+05,1.077419273853302002e+02,0.000000000000000000e+00],
    [7.723430000000000000e+05,-1.254506000000000000e+06,1.872363000000000000e+06,-6.343400000000000000e+04,-1.514537000000000000e+06,-1.932280000000000000e+05,-2.720295000000000000e+06,-5.215990000000000000e+05,1.077906773090362549e+02,0.000000000000000000e+00],
    [7.674530000000000000e+05,-1.259031000000000000e+06,1.864483000000000000e+06,-7.100600000000000000e+04,-1.497469000000000000e+06,-1.765790000000000000e+05,-2.702934000000000000e+06,-5.257140000000000000e+05,1.077908425331115723e+02,0.000000000000000000e+00],
    [7.686460000000000000e+05,-1.257715000000000000e+06,1.867515000000000000e+06,-6.804400000000000000e+04,-1.491868000000000000e+06,-1.709460000000000000e+05,-2.696964000000000000e+06,-5.247480000000000000e+05,1.077916524410247803e+02,0.000000000000000000e+00],
    [7.713970000000000000e+05,-1.255114000000000000e+06,1.869962000000000000e+06,-6.504700000000000000e+04,-1.498740000000000000e+06,-1.777260000000000000e+05,-2.704133000000000000e+06,-5.215920000000000000e+05,1.077920243740081787e+02,0.000000000000000000e+00],
    [7.747550000000000000e+05,-1.251996000000000000e+06,1.873301000000000000e+06,-6.208900000000000000e+04,-1.512067000000000000e+06,-1.910920000000000000e+05,-2.717725000000000000e+06,-5.188190000000000000e+05,1.077921833992004395e+02,0.000000000000000000e+00],
    [7.704930000000000000e+05,-1.256097000000000000e+06,1.868051000000000000e+06,-6.737200000000000000e+04,-1.498371000000000000e+06,-1.778120000000000000e+05,-2.704202000000000000e+06,-5.230410000000000000e+05,1.077930822372436523e+02,0.000000000000000000e+00],
    [7.700880000000000000e+05,-1.256462000000000000e+06,1.867913000000000000e+06,-6.765900000000000000e+04,-1.489393000000000000e+06,-1.684660000000000000e+05,-2.694929000000000000e+06,-5.227210000000000000e+05,1.077940003871917725e+02,0.000000000000000000e+00],
    [7.708820000000000000e+05,-1.255964000000000000e+06,1.869507000000000000e+06,-6.608200000000000000e+04,-1.497514000000000000e+06,-1.762250000000000000e+05,-2.703387000000000000e+06,-5.220470000000000000e+05,1.077945246696472168e+02,0.000000000000000000e+00],
    [7.729210000000000000e+05,-1.254146000000000000e+06,1.871505000000000000e+06,-6.414600000000000000e+04,-1.511946000000000000e+06,-1.905940000000000000e+05,-2.717972000000000000e+06,-5.199870000000000000e+05,1.077946865558624268e+02,0.000000000000000000e+00],
    [7.711790000000000000e+05,-1.255640000000000000e+06,1.871339000000000000e+06,-6.441200000000000000e+04,-1.504222000000000000e+06,-1.832550000000000000e+05,-2.710077000000000000e+06,-5.225040000000000000e+05,1.077954771518707275e+02,0.000000000000000000e+00],
    [7.717940000000000000e+05,-1.254801000000000000e+06,1.868733000000000000e+06,-6.736600000000000000e+04,-1.489301000000000000e+06,-1.684160000000000000e+05,-2.694499000000000000e+06,-5.214690000000000000e+05,1.077956871986389160e+02,0.000000000000000000e+00],
    [7.732450000000000000e+05,-1.253464000000000000e+06,1.868047000000000000e+06,-6.804400000000000000e+04,-1.496008000000000000e+06,-1.749650000000000000e+05,-2.701297000000000000e+06,-5.191310000000000000e+05,1.077965021133422852e+02,0.000000000000000000e+00],
    [7.738370000000000000e+05,-1.252922000000000000e+06,1.870833000000000000e+06,-6.518100000000000000e+04,-1.509038000000000000e+06,-1.879540000000000000e+05,-2.714432000000000000e+06,-5.181510000000000000e+05,1.077969794273376465e+02,0.000000000000000000e+00],
    [7.726610000000000000e+05,-1.253942000000000000e+06,1.869382000000000000e+06,-6.658000000000000000e+04,-1.508597000000000000e+06,-1.877640000000000000e+05,-2.713972000000000000e+06,-5.195610000000000000e+05,1.077971417903900146e+02,0.000000000000000000e+00],
    [7.727800000000000000e+05,-1.253644000000000000e+06,1.868158000000000000e+06,-6.772700000000000000e+04,-1.489338000000000000e+06,-1.688490000000000000e+05,-2.694068000000000000e+06,-5.193210000000000000e+05,1.077978770732879639e+02,0.000000000000000000e+00],
    [7.737760000000000000e+05,-1.252692000000000000e+06,1.868958000000000000e+06,-6.722900000000000000e+04,-1.494442000000000000e+06,-1.738360000000000000e+05,-2.699189000000000000e+06,-5.188610000000000000e+05,1.078502399921417236e+02,0.000000000000000000e+00],
    [7.733700000000000000e+05,-1.253388000000000000e+06,1.868477000000000000e+06,-6.771200000000000000e+04,-1.506078000000000000e+06,-1.854290000000000000e+05,-2.711100000000000000e+06,-5.213520000000000000e+05,1.078508830070495605e+02,0.000000000000000000e+00],
    [7.703220000000000000e+05,-1.256483000000000000e+06,1.866721000000000000e+06,-6.928600000000000000e+04,-1.510982000000000000e+06,-1.905810000000000000e+05,-2.716266000000000000e+06,-5.246920000000000000e+05,1.078512918949127197e+02,0.000000000000000000e+00],
    [7.641910000000000000e+05,-1.262351000000000000e+06,1.865499000000000000e+06,-7.064000000000000000e+04,-1.490269000000000000e+06,-1.699870000000000000e+05,-2.695291000000000000e+06,-5.265040000000000000e+05,1.078513877391815186e+02,0.000000000000000000e+00],
    [7.647810000000000000e+05,-1.261919000000000000e+06,1.870646000000000000e+06,-6.563100000000000000e+04,-1.493946000000000000e+06,-1.731280000000000000e+05,-2.699004000000000000e+06,-5.230260000000000000e+05,1.078520753383636475e+02,0.000000000000000000e+00],
    [7.651120000000000000e+05,-1.261747000000000000e+06,1.870434000000000000e+06,-6.599600000000000000e+04,-1.504412000000000000e+06,-1.833320000000000000e+05,-2.709753000000000000e+06,-5.216550000000000000e+05,1.078521671295166016e+02,0.000000000000000000e+00],
    [7.622030000000000000e+05,-1.264645000000000000e+06,1.866950000000000000e+06,-6.918900000000000000e+04,-1.514774000000000000e+06,-1.938070000000000000e+05,-2.720208000000000000e+06,-5.211750000000000000e+05,1.078527886867523193e+02,0.000000000000000000e+00],
    [7.577510000000000000e+05,-1.269007000000000000e+06,1.865986000000000000e+06,-7.054000000000000000e+04,-1.493783000000000000e+06,-1.731470000000000000e+05,-2.698962000000000000e+06,-5.239600000000000000e+05,1.078531770706176758e+02,0.000000000000000000e+00],
    [7.592980000000000000e+05,-1.267571000000000000e+06,1.869543000000000000e+06,-6.699500000000000000e+04,-1.494069000000000000e+06,-1.728890000000000000e+05,-2.699070000000000000e+06,-5.219330000000000000e+05,1.078532712459564209e+02,0.000000000000000000e+00],
    [7.602540000000000000e+05,-1.266741000000000000e+06,1.867313000000000000e+06,-6.922800000000000000e+04,-1.503636000000000000e+06,-1.821210000000000000e+05,-2.708825000000000000e+06,-5.211700000000000000e+05,1.078539156913757324e+02,0.000000000000000000e+00],
    [7.638090000000000000e+05,-1.263105000000000000e+06,1.865424000000000000e+06,-7.126900000000000000e+04,-1.517495000000000000e+06,-1.958760000000000000e+05,-2.722532000000000000e+06,-5.217170000000000000e+05,1.078540732860565186e+02,0.000000000000000000e+00],
    [7.664080000000000000e+05,-1.260148000000000000e+06,1.866053000000000000e+06,-7.026300000000000000e+04,-1.498343000000000000e+06,-1.772260000000000000e+05,-2.702866000000000000e+06,-5.254320000000000000e+05,1.078548772335052490e+02,0.000000000000000000e+00],
    [7.751120000000000000e+05,-1.251446000000000000e+06,1.867483000000000000e+06,-6.899900000000000000e+04,-1.491668000000000000e+06,-1.705410000000000000e+05,-2.695712000000000000e+06,-5.220380000000000000e+05,1.078553528785705566e+02,0.000000000000000000e+00],
    [7.793890000000000000e+05,-1.247189000000000000e+06,1.865225000000000000e+06,-7.135400000000000000e+04,-1.499017000000000000e+06,-1.778760000000000000e+05,-2.703292000000000000e+06,-5.194170000000000000e+05,1.078554484844207764e+02,0.000000000000000000e+00],
    [7.805550000000000000e+05,-1.246158000000000000e+06,1.867077000000000000e+06,-6.963200000000000000e+04,-1.513404000000000000e+06,-1.922790000000000000e+05,-2.717779000000000000e+06,-5.185610000000000000e+05,1.078561244010925293e+02,0.000000000000000000e+00],
    [7.743850000000000000e+05,-1.252122000000000000e+06,1.864614000000000000e+06,-7.207700000000000000e+04,-1.500191000000000000e+06,-1.795180000000000000e+05,-2.704432000000000000e+06,-5.225370000000000000e+05,1.079094266891479492e+02,0.000000000000000000e+00],
    [7.726110000000000000e+05,-1.253962000000000000e+06,1.867888000000000000e+06,-6.875200000000000000e+04,-1.490086000000000000e+06,-1.691940000000000000e+05,-2.693790000000000000e+06,-5.197170000000000000e+05,1.079096150398254395e+02,0.000000000000000000e+00],
    [7.718620000000000000e+05,-1.255017000000000000e+06,1.871670000000000000e+06,-6.505200000000000000e+04,-1.497467000000000000e+06,-1.762710000000000000e+05,-2.701377000000000000e+06,-5.171910000000000000e+05,1.079100365638732910e+02,0.000000000000000000e+00],
    [7.723090000000000000e+05,-1.254681000000000000e+06,1.870668000000000000e+06,-6.603600000000000000e+04,-1.512292000000000000e+06,-1.910510000000000000e+05,-2.716428000000000000e+06,-5.180450000000000000e+05,1.079101901054382324e+02,0.000000000000000000e+00],
    [7.672060000000000000e+05,-1.259644000000000000e+06,1.866162000000000000e+06,-7.021200000000000000e+04,-1.505631000000000000e+06,-1.847240000000000000e+05,-2.709721000000000000e+06,-5.232710000000000000e+05,1.079112904071807861e+02,0.000000000000000000e+00],
    [7.670660000000000000e+05,-1.259899000000000000e+06,1.864287000000000000e+06,-7.219100000000000000e+04,-1.490970000000000000e+06,-1.700410000000000000e+05,-2.694512000000000000e+06,-5.241550000000000000e+05,1.079115366935729980e+02,0.000000000000000000e+00],
    [7.684710000000000000e+05,-1.258716000000000000e+06,1.864838000000000000e+06,-7.198700000000000000e+04,-1.497916000000000000e+06,-1.766870000000000000e+05,-2.701585000000000000e+06,-5.221730000000000000e+05,1.079118556976318359e+02,0.000000000000000000e+00],
    [7.709660000000000000e+05,-1.256421000000000000e+06,1.867293000000000000e+06,-6.954900000000000000e+04,-1.510692000000000000e+06,-1.893660000000000000e+05,-2.714433000000000000e+06,-5.201220000000000000e+05,1.079121277332305908e+02,0.000000000000000000e+00],
    [7.687020000000000000e+05,-1.258444000000000000e+06,1.868910000000000000e+06,-6.793400000000000000e+04,-1.510094000000000000e+06,-1.889640000000000000e+05,-2.713689000000000000e+06,-5.218310000000000000e+05,1.079122791290283203e+02,0.000000000000000000e+00],
    [7.672880000000000000e+05,-1.259635000000000000e+06,1.866413000000000000e+06,-7.035800000000000000e+04,-1.491141000000000000e+06,-1.703490000000000000e+05,-2.694129000000000000e+06,-5.229290000000000000e+05,1.079124305248260498e+02,0.000000000000000000e+00],
    [7.693470000000000000e+05,-1.257658000000000000e+06,1.865817000000000000e+06,-7.102600000000000000e+04,-1.496338000000000000e+06,-1.753790000000000000e+05,-2.699317000000000000e+06,-5.213130000000000000e+05,1.079139988422393799e+02,0.000000000000000000e+00],
    [7.715190000000000000e+05,-1.255763000000000000e+06,1.866208000000000000e+06,-7.068400000000000000e+04,-1.507236000000000000e+06,-1.862570000000000000e+05,-2.710445000000000000e+06,-5.197510000000000000e+05,1.079166150093078613e+02,0.000000000000000000e+00],
    [7.692960000000000000e+05,-1.257866000000000000e+06,1.865221000000000000e+06,-7.140400000000000000e+04,-1.512624000000000000e+06,-1.918160000000000000e+05,-2.716086000000000000e+06,-5.210570000000000000e+05,1.079168045520782471e+02,0.000000000000000000e+00],
    [7.656240000000000000e+05,-1.261142000000000000e+06,1.864383000000000000e+06,-7.238500000000000000e+04,-1.491692000000000000e+06,-1.710620000000000000e+05,-2.694738000000000000e+06,-5.227700000000000000e+05,1.079169797897338867e+02,0.000000000000000000e+00],
    [7.672340000000000000e+05,-1.259624000000000000e+06,1.868883000000000000e+06,-6.794200000000000000e+04,-1.494324000000000000e+06,-1.733890000000000000e+05,-2.697372000000000000e+06,-5.199430000000000000e+05,1.079182796478271484e+02,0.000000000000000000e+00],
    [7.692680000000000000e+05,-1.258050000000000000e+06,1.871159000000000000e+06,-6.552300000000000000e+04,-1.503675000000000000e+06,-1.826910000000000000e+05,-2.707100000000000000e+06,-5.200990000000000000e+05,1.079696657657623291e+02,0.000000000000000000e+00],
    [7.691330000000000000e+05,-1.258072000000000000e+06,1.869043000000000000e+06,-6.754500000000000000e+04,-1.514268000000000000e+06,-1.934460000000000000e+05,-2.717979000000000000e+06,-5.226520000000000000e+05,1.079704408645629883e+02,0.000000000000000000e+00],
]).astype(float)

class TestFileReaderData(unittest.TestCase):
    # Suppresses scientific notation for this context
    np.set_printoptions(suppress=True)

    def valid_data_callback(self, dataArray):
        dataArraySanitized = (np.array(dataArray)).astype(float)
        correctDataArray = (correctDataSanitized[self.currentLine])
        np.testing.assert_array_equal(dataArraySanitized, correctDataArray[0:8])
        self.currentLine = self.currentLine+1

    def test_correct_data(self):
        # Input file
        script_dir = os.path.dirname(__file__)
        rel_path = "input_data.csv"
        abs_file_path = os.path.join(script_dir, rel_path)
        fileName = script_dir = abs_file_path

        transmissionFrequency = 100

        # Range 0 to 8
        startCSVcolumn = 0
        endCSVcolumn = 8

        self.currentLine = 0

        fileReader = FileReader(self.valid_data_callback, fileName, transmissionFrequency, startCSVcolumn, endCSVcolumn)
        fileReader.start()
        fileReader.join()

class TestFileReaderFrequency(unittest.TestCase):
    def test_correct_frequency(self):
        # Input file
        script_dir = os.path.dirname(__file__)
        rel_path = "input_data.csv"
        abs_file_path = os.path.join(script_dir, rel_path)
        fileName = script_dir = abs_file_path

        self.correctTransmissionFrequency = 250
        self.ignoreFirst = True
        
        # Range 0 to 8
        startCSVcolumn = 0
        endCSVcolumn = 8

        fileReader = FileReader(self.valid_frequency_callback, fileName, self.correctTransmissionFrequency, startCSVcolumn, endCSVcolumn)
        # Starting time
        self.lastRecordedTime = time.thread_time_ns()
        fileReader.start()
        fileReader.join()

    def valid_frequency_callback(self, dataArray):
        # Ignores the first value
        if self.ignoreFirst:
            self.ignoreFirst = False
        else:
            # To pass this test, it needs to be close to frequency
            currentTimeNs = time.thread_time_ns()
            # Seconds
            elapsedTimeNs = abs(self.lastRecordedTime - currentTimeNs)
            # Ms
            #elapsedTimeNs = elapsedTime * 1000
            differenceInTime = abs(elapsedTimeNs - self.correctTransmissionFrequency)

            # Passes if difference less than 50ms
            self.assertTrue(differenceInTime < 50000000)
            self.lastRecordedTime = currentTimeNs

if __name__ == '__main__':
    try:
        unittest.main()
    except Exception as e:
        print(e)
        raise

